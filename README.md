# CNN模型实现数据插值

---


本项目是一个基于卷积神经网络（CNN）的数据插值任务。具体内容如下：

## 一、数据准备

神经网络的特征：2x64x64,标签：64x64x4。
printStr()函数的输入：2x64x64的tensor数据，输出：指定格式的result数据

## 二、CNN模型

定义了一个6层卷积神经网络，每个卷积层后面跟着一个ReLU激活函数。

## 三、参数设置和优化器

使用Adam优化器，学习率设置为0.001。损失函数为均方误差（MSE）。

## 四、训练流程

将数据集划分为batch，并在每个epoch中对其进行迭代训练。

## 五、测试流程

使用与训练集相同的方式生成测试数据集，然后用训练好的模型在测试集上进行预测，并计算预测结果与真实标签之间的均方误差。

## 六、输出结果

根据上述流程，返回指定的格式result。result包括两个列表，第一个列表存的是内部weights,第二个存的是边框weights，且边框的顺序为上（左到右），下（左到右），左（下到上），右（下到上）从而实现基于CNN的任务。

## 项目流程介绍
首先在openfoam2212中自定义求解器，接下来，再复现kolmogorov案例，修改里面的参数（包括网格数，雷诺数，delta T,endtime等参数），然后生成共48s时间的数据，共40个文件夹，一个文件夹中delta为0.01，每个文件夹有4800个时间步。然后将最终生成后得到的网格数据（2.8T），网格大小512x512按照8x8的池化转换为64x64x2大小。
从而得到matrix_64。再根据该数据得到面心值（通过512x512矩阵中相邻两个边框8x2求平均得到），神经网络训练时，输入就是matrix_64（2x64x64）,输出是面心值（64x64x2)。由面心值得到a值，a = (E-A)/(B-A)，再根据a值得到相应的weights。
weights按照格式转换，转换为最终输出，即为指定格式的result。


---

## 安装指南

1. 下载代码仓库
```git clone https://gitee.com/qu-zhijie-666/cnn.git```

2. 安装依赖包
```pip install -r requirements.txt```

3. 运行神经网络的预测模块，在forward文件夹下（除了forward文件夹下的所有文件，其他文件在预测时用不到，故不用下载），执行以下命令
```python run.py```